{%- capture enable_products -%}
{%- render 'visibility-check', checkFromCart: true -%}
{%- endcapture -%}

{% if enable_products == 'true' %}
  <script>
    var block_settings = {{ block.settings | json }};
    {% if block.settings.custom_icon %}
      block_settings.custom_icon_tag = '{{ block.settings.custom_icon | image_url: width: 16 | image_tag }}';
    {% else %}
      block_settings.custom_icon = '';
    {% endif %}
    Fastify.widgets['cart_countdown_timer'].push(block_settings);
  </script>
{% endif %}

{% schema %}
{
  "name": "t:blocks.cart-countdown-timer.settings.block_name",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:general.settings.block-name.label",
      "info": "t:general.settings.block-name.info",
      "default": "t:blocks.cart-countdown-timer.settings.block_name"
    },
    {
      "type": "select",
      "id": "show_on",
      "label": "t:sections.all.show_on.label",
      "default": "both",
      "options": [
        {
          "value": "desktop-only",
          "label": "t:sections.all.show_on.options__1.label"
        },
        {
          "value": "mobile-only",
          "label": "t:sections.all.show_on.options__2.label"
        },
        {
          "value": "both",
          "label": "t:sections.all.show_on.options__3.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:general.settings.content"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "t:general.settings.text",
      "default": "t:blocks.cart-countdown-timer.settings.message_default",
      "info": "t:blocks.cart-countdown-timer.settings.message_info"
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "t:general.settings.alignment.label",
      "default": "justify-content-left",
      "options": [
        { "value": "justify-content-left", "label": "t:general.settings.alignment.option__4" },
        { "value": "justify-content-center", "label": "t:general.settings.alignment.option__5" },
        { "value": "justify-content-right", "label": "t:general.settings.alignment.option__6" }
      ]
    },
    {
      "type": "text",
      "id": "hours",
      "label": "t:blocks.cart-countdown-timer.settings.hours_label",
      "default": "2",
      "info": "t:blocks.cart-countdown-timer.settings.hours_info"
    },
    {
      "type": "text",
      "id": "minutes",
      "label": "t:blocks.cart-countdown-timer.settings.minutes_label",
      "default": "49",
      "info": "t:blocks.cart-countdown-timer.settings.minutes_info"
    },
    {
      "type": "text",
      "id": "seconds",
      "label": "t:blocks.cart-countdown-timer.settings.seconds_label",
      "default": "59",
      "info": "t:blocks.cart-countdown-timer.settings.seconds_info"
    },
    {
      "type": "text",
      "id": "icon",
      "label": "t:blocks.double_button.icon.label",
      "default": "t:blocks.double_button.icon.default",
      "info": "t:general.settings.icon_info"
    },
    {
      "type": "image_picker",
      "id": "custom_icon",
      "label": "t:blocks.double_button.custom_icon.label",
      "info": "t:blocks.double_button.custom_icon.info"
    },
    {
      "type": "header",
      "content": "t:general.settings.visibility.header.content",
      "info": "t:general.settings.visibility.header.info"
    },
    {
      "type": "radio",
      "id": "visibility",
      "label": "t:general.settings.visibility.visibility.label",
      "info": "t:general.settings.visibility.visibility.info",
      "default": "all",
      "options": [
        {
          "value": "all",
          "label": "t:general.settings.visibility.visibility.options__1.label"
        },
        {
          "value": "collection",
          "label": "t:general.settings.visibility.visibility.options__2.label"
        },
        {
          "value": "type",
          "label": "t:general.settings.visibility.visibility.options__3.label"
        },
        {
          "value": "tag",
          "label": "t:general.settings.visibility.visibility.options__4.label"
        },
        {
          "value": "product",
          "label": "t:general.settings.visibility.visibility.options__5.label"
        }
      ]
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "t:general.settings.visibility.collection.label"
    },
    {
      "type": "text",
      "id": "types",
      "label": "t:general.settings.visibility.types.label",
      "info": "t:general.settings.visibility.types.info"
    },
    {
      "type": "text",
      "id": "tags",
      "label": "t:general.settings.visibility.tags.label",
      "info": "t:general.settings.visibility.tags.info"
    },
    {
      "type": "product",
      "id": "product",
      "label": "t:general.settings.visibility.product.label"
    }
  ],
  "presets": [
    {
      "name": "t:blocks.cart-countdown-timer.settings.block_name"
    }
  ]
}
{% endschema %}
